<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸–ç•Œæ™‚è¨ˆ</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            background-color: #f5f5f5;
            color: #333333;
            padding: 10px;
            margin: 0;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            transition: background 1s ease;
            position: relative;
        }
        
        /* èƒŒæ™¯ãƒ‘ã‚¿ãƒ¼ãƒ³1: ç¸¦ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆç©ºï¼‰ */
        body.bg-pattern-1 {
            background: linear-gradient(to bottom, #e6f3ff 0%, #fff5e6 100%);
        }
        
        /* èƒŒæ™¯ãƒ‘ã‚¿ãƒ¼ãƒ³2: æ–œã‚ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆç´«â†’ãƒ”ãƒ³ã‚¯ï¼‰ */
        body.bg-pattern-2 {
            background: linear-gradient(135deg, #f3e8ff 0%, #ffe8f3 100%);
        }
        
        /* èƒŒæ™¯ãƒ‘ã‚¿ãƒ¼ãƒ³3: æ”¾å°„çŠ¶ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ */
        body.bg-pattern-3 {
            background: radial-gradient(circle at center, #ffffff 0%, #faf8f3 100%);
        }
        
        /* èƒŒæ™¯ãƒ‘ã‚¿ãƒ¼ãƒ³4: ãƒ‰ãƒƒãƒˆãƒ‘ã‚¿ãƒ¼ãƒ³ */
        body.bg-pattern-4 {
            background-color: #fafafa;
            background-image: radial-gradient(circle, #f0f0f0 1px, transparent 1px);
            background-size: 20px 20px;
        }
        
        /* èƒŒæ™¯ãƒ‘ã‚¿ãƒ¼ãƒ³5: æ–œã‚ã‚¹ãƒˆãƒ©ã‚¤ãƒ— */
        body.bg-pattern-5 {
            background: repeating-linear-gradient(
                45deg,
                #ffffff,
                #ffffff 10px,
                #f8f8f8 10px,
                #f8f8f8 20px
            );
        }
        
        /* èƒŒæ™¯ãƒ‘ã‚¿ãƒ¼ãƒ³6: æ³¢æ¨¡æ§˜ */
        body.bg-pattern-6 {
            background: 
                radial-gradient(ellipse at top, #e6f3ff 0%, transparent 70%),
                radial-gradient(ellipse at bottom, #fff5e6 0%, transparent 70%),
                #f5f8fa;
        }
        
        .container {
            background-color: rgba(255, 255, 255, 0.9);
            padding: 20px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            max-width: 900px;
            width: 100%;
            margin: 0;
        }
        
        h1 {
            text-align: center;
            color: #2563eb;
            margin-bottom: 30px;
            font-size: 24px;
        }
        
        .clock-display {
            margin-bottom: 8px;
            padding: 8px 12px;
            background-color: #f8f8f8;
            border-radius: 4px;
            font-size: 14px;
            line-height: 1.6;
            white-space: nowrap;
            overflow-x: auto;
        }
        
        .time-group {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }
        
        .time-item {
            flex: 1;
            min-width: 150px;
            padding: 8px;
            background-color: #252526;
            border-radius: 4px;
            text-align: center;
        }
        
        .clock-display:hover {
            background-color: #efefef;
        }
        
        .time-label {
            color: #2c7a7b;
        }
        
        .date {
            color: #744210;
        }
        
        .day {
            color: #9c4221;
        }
        
        .separator {
            color: #a0a0a0;
        }
        
        @media (max-width: 768px) {
            body {
                padding: 0;
                align-items: flex-start;
                height: 100vh;
                overflow: hidden;
            }
            
            .container {
                padding: 0;
                margin: 0;
                height: 100vh;
                overflow-y: auto;
                display: flex;
                flex-direction: column;
                background-color: rgba(255, 255, 255, 0.9);
            }
            
            h1 {
                font-size: 16px;
                margin: 0;
                padding: 8px 8px 4px 8px;
            }
            
            #clockContainer {
                flex: 1;
                overflow-y: auto;
                padding: 0 8px 8px 8px;
            }
            
            .clock-display {
                font-size: 15px;
                padding: 0;
                white-space: normal;
                overflow-x: visible;
                margin-bottom: 6px;
                background-color: transparent !important;
                border: none !important;
            }
            
            .time-group {
                display: flex;
                flex-wrap: nowrap;
                gap: 1px;
                width: 100%;
            }
            
            .time-item {
                flex: 1;
                padding: 5px 6px;
                text-align: left;
                font-size: 15px;
                background-color: #f0f0f0;
                line-height: 1.6;
                border-radius: 3px;
                min-width: 0;
                overflow: hidden;
                color: white;
                font-weight: 500;
                text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
            }
            
            .separator {
                display: none;
            }
            
            
            /* åŒºåˆ‡ã‚Šç·šã‚’éè¡¨ç¤º */
            .clock-display + div[style*="border-bottom"] {
                display: none !important;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸŒ ä¸–ç•Œæ™‚è¨ˆ</h1>
        <div style="text-align: center; margin-bottom: 10px; font-size: 12px; color: #666;">
            èƒŒæ™¯ãƒ‘ã‚¿ãƒ¼ãƒ³: <span id="bgPatternNumber">1</span> / 6
            <button onclick="toggleBgRotation()" style="margin-left: 10px; padding: 2px 8px; font-size: 11px;">ä¸€æ™‚åœæ­¢</button>
            <div id="debugInfo" style="margin-top: 5px; font-size: 10px; color: #999;"></div>
        </div>
        <div id="clockContainer"></div>
    </div>

    <script>
        const wdays = ['æ—¥', 'æœˆ', 'ç«', 'æ°´', 'æœ¨', 'é‡‘', 'åœŸ'];
        const baseHours = [0, 4, 8, 12, 16, 20];
        
        function isBST(date) {
            const month = date.getMonth() + 1;
            if (month < 3 || month > 10) return false;
            if (month > 3 && month < 10) return true;
            
            if (month === 3) {
                return date.getDate() >= 25;
            } else {
                return date.getDate() < 25;
            }
        }
        
        function isPDT(date) {
            const month = date.getMonth() + 1;
            if (month < 3 || month > 11) return false;
            if (month > 3 && month < 11) return true;
            
            if (month === 3) {
                return date.getDate() >= 10;
            } else {
                return date.getDate() < 7;
            }
        }
        
        function isEDT(date) {
            return isPDT(date);
        }
        
        function getTimeWithOffset(jstTime, timeDiff) {
            // æ—¥æœ¬æ™‚é–“ã‹ã‚‰ä»–ã®åœ°åŸŸã®æ™‚é–“ã‚’è¨ˆç®—
            // timeDiff: æ—¥æœ¬ã¨ã®æ™‚å·®ï¼ˆä¾‹ï¼š-9 = 9æ™‚é–“é…ã„ï¼‰
            const time = new Date(jstTime);
            time.setHours(time.getHours() + timeDiff);
            return time;
        }
        
        function getTimeColor(hour) {
            // æ™‚é–“å¸¯ã«å¿œã˜ãŸèƒŒæ™¯è‰²ã‚’è¿”ã™ï¼ˆç™½èƒŒæ™¯ç”¨ã«æ˜ã‚‹ã„è‰²ã«èª¿æ•´ï¼‰
            if (hour >= 5 && hour < 6) {
                // æ—©æœï¼šé’
                return '#4a90e2';
            } else if (hour >= 6 && hour < 11) {
                // æœï¼šæ°´è‰²
                return '#87ceeb';
            } else if (hour >= 11 && hour <= 14) {
                // æ˜¼ï¼šã‚ªãƒ¬ãƒ³ã‚¸
                return '#ffa500';
            } else if (hour >= 15 && hour <= 18) {
                // å¤•æ–¹ï¼šç´«
                return '#9370db';
            } else if (hour === 19) {
                // å¤œã®å§‹ã¾ã‚Šï¼šæ¿ƒã„ç´«
                return '#7b68ee';
            } else if (hour === 20) {
                // è–„ã„ç´ºè‰²
                return '#6a5acd';
            } else if (hour === 21) {
                // ç´ºè‰²
                return '#4169e1';
            } else if (hour === 22) {
                // æ¿ƒã„ç´ºè‰²
                return '#364ba0';
            } else if (hour === 23) {
                // ã¨ã¦ã‚‚æ¿ƒã„ç´ºè‰²
                return '#2c3e78';
            } else if (hour === 0) {
                // æ·±å¤œï¼šæ¿ƒã„è—è‰²
                return '#191970';
            } else if (hour >= 1 && hour <= 3) {
                // çœŸå¤œä¸­ï¼šã¨ã¦ã‚‚æ¿ƒã„è—è‰²
                return '#0f0f3d';
            } else if (hour === 4) {
                // å¤œæ˜ã‘å‰ï¼šè—è‰²ã‹ã‚‰é’ã¸ã®ç§»è¡Œ
                return '#2a4d80';
            }
        }
        
        function formatTime(date, label) {
            const month = date.getMonth() + 1;
            const day = date.getDate();
            const wday = wdays[date.getDay()];
            const hour = date.getHours();
            const minute = date.getMinutes();
            
            if (window.innerWidth <= 768) {
                // ãƒ¢ãƒã‚¤ãƒ«ç‰ˆ: ã‚ˆã‚Šã‚³ãƒ³ãƒ‘ã‚¯ãƒˆãªè¡¨ç¤º
                const flags = {
                    'æ—¥æœ¬': 'ğŸ‡¯ğŸ‡µ',
                    'ã‚¤ã‚®ãƒªã‚¹': 'ğŸ‡¬ğŸ‡§', 
                    'SF': 'ğŸ‡ºğŸ‡¸',
                    'NY': 'ğŸ‡ºğŸ‡¸'
                };
                const cities = {
                    'æ—¥æœ¬': 'æ±äº¬',
                    'ã‚¤ã‚®ãƒªã‚¹': 'London',
                    'SF': 'SF',
                    'NY': 'NY'
                };
                return `${flags[label]}${cities[label]}<br>${month}/${day}(${wday})<br>${hour}:${minute.toString().padStart(2, '0')}`;
            } else {
                return `<span class="time-label">${label}</span> <span class="date">${month.toString().padStart(2, ' ')}/${day.toString().padStart(2, ' ')}</span><span class="day">(${wday})</span> ${hour.toString().padStart(2, ' ')}:${minute.toString().padStart(2, '0')}`;
            }
        }
        
        function updateClocks() {
            const now = new Date();
            const currentHour = now.getHours();
            
            // ç¾åœ¨æ™‚åˆ»ã«æœ€ã‚‚è¿‘ã„åŸºæº–æ™‚åˆ»ã‚’è¦‹ã¤ã‘ã‚‹
            let startIndex = 0;
            baseHours.forEach((hour, index) => {
                if (currentHour >= hour) {
                    startIndex = index;
                }
            });
            
            // åŸºæº–æ™‚åˆ»ã‚’ä¸¦ã³æ›¿ãˆ
            const sortedHours = [...baseHours.slice(startIndex), ...baseHours.slice(0, startIndex)];
            
            const container = document.getElementById('clockContainer');
            container.innerHTML = '';
            
            // ç¾åœ¨æ™‚åˆ»ã‚’æœ€åˆã®è¡Œã¨ã—ã¦è¿½åŠ 
            const currentRow = document.createElement('div');
            currentRow.className = 'clock-display';
            currentRow.style.background = '#f0f0f0';
            currentRow.style.border = '1px solid #ddd';
            currentRow.style.borderRadius = '4px';
            currentRow.style.padding = '4px';
            currentRow.style.marginBottom = '8px';
            
            // å„åœ°åŸŸã®ç¾åœ¨æ™‚åˆ»ã‚’è¨ˆç®—
            const jstNow = new Date();
            
            // ãƒ‡ãƒãƒƒã‚°æƒ…å ±
            const currentMonth = jstNow.getMonth() + 1;
            const debugElement = document.getElementById('debugInfo');
            debugElement.textContent = `ç¾åœ¨: ${currentMonth}æœˆ | BST: ${isBST(jstNow) ? 'Yes' : 'No'} | PDT/EDT: ${isPDT(jstNow) ? 'Yes' : 'No'}`;
            
            // ã‚¤ã‚®ãƒªã‚¹
            let ukTimeDiff = -9;  // GMTæ™‚ã®æ—¥æœ¬ã¨ã®æ™‚å·®
            const ukNow = getTimeWithOffset(jstNow, ukTimeDiff);
            if (isBST(ukNow)) {
                ukTimeDiff = -8;  // BSTæ™‚ã®æ—¥æœ¬ã¨ã®æ™‚å·®
            }
            const ukNowAdjusted = getTimeWithOffset(jstNow, ukTimeDiff);
            
            // ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³
            let sfTimeDiff = -17;  // PSTæ™‚ã®æ—¥æœ¬ã¨ã®æ™‚å·®
            const sfNow = getTimeWithOffset(jstNow, sfTimeDiff);
            if (isPDT(sfNow)) {
                sfTimeDiff = -16;  // PDTæ™‚ã®æ—¥æœ¬ã¨ã®æ™‚å·®
            }
            const sfNowAdjusted = getTimeWithOffset(jstNow, sfTimeDiff);
            
            // ãƒ‹ãƒ¥ãƒ¼ãƒ¨ãƒ¼ã‚¯
            let nyTimeDiff = -14;  // ESTæ™‚ã®æ—¥æœ¬ã¨ã®æ™‚å·®
            const nyNow = getTimeWithOffset(jstNow, nyTimeDiff);
            if (isEDT(nyNow)) {
                nyTimeDiff = -13;  // EDTæ™‚ã®æ—¥æœ¬ã¨ã®æ™‚å·®
            }
            const nyNowAdjusted = getTimeWithOffset(jstNow, nyTimeDiff);
            
            // ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã¨ãƒ¢ãƒã‚¤ãƒ«ã§ç•°ãªã‚‹ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
            if (window.innerWidth <= 768) {
                currentRow.innerHTML = `
                    <div class="time-group">
                        <div class="time-item" style="background: ${getTimeColor(jstNow.getHours())};">${formatTime(jstNow, 'æ—¥æœ¬')}</div>
                        <div class="time-item" style="background: ${getTimeColor(ukNowAdjusted.getHours())};">${formatTime(ukNowAdjusted, 'ã‚¤ã‚®ãƒªã‚¹')}</div>
                        <div class="time-item" style="background: ${getTimeColor(sfNowAdjusted.getHours())};">${formatTime(sfNowAdjusted, 'SF')}</div>
                        <div class="time-item" style="background: ${getTimeColor(nyNowAdjusted.getHours())};">${formatTime(nyNowAdjusted, 'NY')}</div>
                    </div>
                `;
            } else {
                currentRow.innerHTML = `${formatTime(jstNow, 'æ—¥æœ¬')} <span class="separator">|</span> ${formatTime(ukNowAdjusted, 'ã‚¤ã‚®ãƒªã‚¹')} <span class="separator">|</span> ${formatTime(sfNowAdjusted, 'SF')} <span class="separator">|</span> ${formatTime(nyNowAdjusted, 'NY')}`;
            }
            container.appendChild(currentRow);
            
            // åŒºåˆ‡ã‚Šç·šã‚’è¿½åŠ 
            const divider = document.createElement('div');
            divider.style.borderBottom = '1px solid #e0e0e0';
            divider.style.margin = '10px 0';
            container.appendChild(divider);
            
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            sortedHours.forEach((hour, index) => {
                const useDate = new Date(today);
                
                // ç¾åœ¨æ™‚åˆ»ã‚ˆã‚Šå‰ã®æ™‚é–“ã¯æ˜æ—¥ã®æ—¥ä»˜ã«ã™ã‚‹
                if (index > 0 && hour < sortedHours[0]) {
                    useDate.setDate(useDate.getDate() + 1);
                }
                
                // æ—¥æœ¬æ™‚é–“ã‚’åŸºæº–ã«ã™ã‚‹
                const jstTime = new Date(useDate);
                jstTime.setHours(hour, 0, 0, 0);
                
                // å„åœ°åŸŸã®æ™‚åˆ»ã‚’è¨ˆç®—
                // ã‚¤ã‚®ãƒªã‚¹
                let ukTimeDiff = -9;  // GMTæ™‚ã®æ—¥æœ¬ã¨ã®æ™‚å·®
                const ukTime = getTimeWithOffset(jstTime, ukTimeDiff);
                if (isBST(ukTime)) {
                    ukTimeDiff = -8;  // BSTæ™‚ã®æ—¥æœ¬ã¨ã®æ™‚å·®
                }
                const ukTimeAdjusted = getTimeWithOffset(jstTime, ukTimeDiff);
                
                // ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³
                let sfTimeDiff = -17;  // PSTæ™‚ã®æ—¥æœ¬ã¨ã®æ™‚å·®
                const sfTime = getTimeWithOffset(jstTime, sfTimeDiff);
                if (isPDT(sfTime)) {
                    sfTimeDiff = -16;  // PDTæ™‚ã®æ—¥æœ¬ã¨ã®æ™‚å·®
                }
                const sfTimeAdjusted = getTimeWithOffset(jstTime, sfTimeDiff);
                
                // ãƒ‹ãƒ¥ãƒ¼ãƒ¨ãƒ¼ã‚¯
                let nyTimeDiff = -14;  // ESTæ™‚ã®æ—¥æœ¬ã¨ã®æ™‚å·®
                const nyTime = getTimeWithOffset(jstTime, nyTimeDiff);
                if (isEDT(nyTime)) {
                    nyTimeDiff = -13;  // EDTæ™‚ã®æ—¥æœ¬ã¨ã®æ™‚å·®
                }
                const nyTimeAdjusted = getTimeWithOffset(jstTime, nyTimeDiff);
                
                // ä¸€è¡Œã§å‡ºåŠ›
                const row = document.createElement('div');
                row.className = 'clock-display';
                
                // ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã¨ãƒ¢ãƒã‚¤ãƒ«ã§ç•°ãªã‚‹ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
                if (window.innerWidth <= 768) {
                    row.innerHTML = `
                        <div class="time-group">
                            <div class="time-item" style="background: ${getTimeColor(jstTime.getHours())};">${formatTime(jstTime, 'æ—¥æœ¬')}</div>
                            <div class="time-item" style="background: ${getTimeColor(ukTimeAdjusted.getHours())};">${formatTime(ukTimeAdjusted, 'ã‚¤ã‚®ãƒªã‚¹')}</div>
                            <div class="time-item" style="background: ${getTimeColor(sfTimeAdjusted.getHours())};">${formatTime(sfTimeAdjusted, 'SF')}</div>
                            <div class="time-item" style="background: ${getTimeColor(nyTimeAdjusted.getHours())};">${formatTime(nyTimeAdjusted, 'NY')}</div>
                        </div>
                    `;
                } else {
                    row.innerHTML = `${formatTime(jstTime, 'æ—¥æœ¬')} <span class="separator">|</span> ${formatTime(ukTimeAdjusted, 'ã‚¤ã‚®ãƒªã‚¹')} <span class="separator">|</span> ${formatTime(sfTimeAdjusted, 'SF')} <span class="separator">|</span> ${formatTime(nyTimeAdjusted, 'NY')}`;
                }
                
                container.appendChild(row);
            });
        }
        
        // åˆå›å®Ÿè¡Œ
        updateClocks();
        
        // 1ç§’ã”ã¨ã«æ›´æ–°
        setInterval(updateClocks, 1000);
        
        // ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãƒªã‚µã‚¤ã‚ºæ™‚ã«å†æç”»
        let resizeTimeout;
        window.addEventListener('resize', () => {
            clearTimeout(resizeTimeout);
            resizeTimeout = setTimeout(() => {
                updateClocks();
            }, 250);
        });
        
        // èƒŒæ™¯ãƒ‘ã‚¿ãƒ¼ãƒ³ã®åˆ‡ã‚Šæ›¿ãˆæ©Ÿèƒ½
        let currentBgPattern = 1;
        let bgRotationInterval;
        let isRotating = true;
        
        function switchBackground() {
            // ç¾åœ¨ã®ã‚¯ãƒ©ã‚¹ã‚’å‰Šé™¤
            for (let i = 1; i <= 6; i++) {
                document.body.classList.remove(`bg-pattern-${i}`);
            }
            
            // æ¬¡ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã«åˆ‡ã‚Šæ›¿ãˆ
            currentBgPattern = (currentBgPattern % 6) + 1;
            document.body.classList.add(`bg-pattern-${currentBgPattern}`);
            
            // è¡¨ç¤ºã‚’æ›´æ–°
            document.getElementById('bgPatternNumber').textContent = currentBgPattern;
        }
        
        function startBgRotation() {
            bgRotationInterval = setInterval(switchBackground, 5000);
        }
        
        function toggleBgRotation() {
            const button = event.target;
            if (isRotating) {
                clearInterval(bgRotationInterval);
                button.textContent = 'å†é–‹';
                isRotating = false;
            } else {
                startBgRotation();
                button.textContent = 'ä¸€æ™‚åœæ­¢';
                isRotating = true;
            }
        }
        
        // åˆæœŸè¨­å®š
        window.addEventListener('DOMContentLoaded', () => {
            document.body.classList.add('bg-pattern-1');
            startBgRotation();
        });
    </script>
</body>
</html>